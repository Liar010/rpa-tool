<Window x:Class="RPAEditor.Dialogs.ExcelCellDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Excel: セル操作" Height="550" Width="500"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 操作タイプ -->
        <TextBlock Grid.Row="0" Text="操作タイプ:" Margin="0,0,0,5"/>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
            <RadioButton x:Name="rbRead" Content="読み取り" IsChecked="True" Margin="0,0,20,0" Checked="OperationType_Changed"/>
            <RadioButton x:Name="rbWrite" Content="書き込み" Checked="OperationType_Changed"/>
        </StackPanel>

        <!-- ファイル参照方法 -->
        <TextBlock Grid.Row="2" Text="ファイルの指定方法:" Margin="0,0,0,5"/>
        <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,0,0,15">
            <RadioButton x:Name="rbUseFilePath" Content="ファイルパスで指定" IsChecked="True" Margin="0,0,20,0" Checked="ReferenceMethod_Changed"/>
            <RadioButton x:Name="rbUseOpenAction" Content="開くアクション番号で指定" Checked="ReferenceMethod_Changed"/>
        </StackPanel>

        <!-- ファイルパス -->
        <TextBlock x:Name="lblFilePath" Grid.Row="4" Text="Excelファイルパス:" Margin="0,0,0,5"/>
        <Grid x:Name="gridFilePath" Grid.Row="5" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBox x:Name="txtFilePath" Grid.Column="0" Margin="0,0,5,0" VerticalContentAlignment="Center"/>
            <Button x:Name="btnBrowse" Grid.Column="1" Content="参照..." Width="80" Click="BtnBrowse_Click"/>
        </Grid>

        <!-- 開くアクション番号 -->
        <TextBlock x:Name="lblOpenAction" Grid.Row="4" Text="開くアクション:" Margin="0,0,0,5" Visibility="Collapsed"/>
        <ComboBox x:Name="cmbOpenActions" Grid.Row="5" Margin="0,0,0,15" Visibility="Collapsed"/>

        <!-- シート名 -->
        <TextBlock Grid.Row="6" Text="シート名（省略時は最初のシート）:" Margin="0,0,0,5"/>
        <TextBox x:Name="txtSheetName" Grid.Row="7" Margin="0,0,0,15" VerticalContentAlignment="Center"/>

        <!-- セルアドレス -->
        <TextBlock Grid.Row="8" Text="セルアドレス（例: A1, B2）:" Margin="0,0,0,5"/>
        <TextBox x:Name="txtCellAddress" Grid.Row="9" Margin="0,0,0,15" VerticalContentAlignment="Center"/>

        <!-- 書き込み値の指定方法（書き込みの場合のみ表示） -->
        <TextBlock x:Name="lblValueMethod" Grid.Row="10" Text="書き込む値の指定方法:" Margin="0,0,0,5" Visibility="Collapsed"/>
        <StackPanel x:Name="spValueMethod" Grid.Row="11" Orientation="Horizontal" Margin="0,0,0,15" Visibility="Collapsed">
            <RadioButton x:Name="rbDirectValue" Content="直接入力" IsChecked="True" Margin="0,0,20,0" Checked="ValueMethod_Changed"/>
            <RadioButton x:Name="rbReadActionValue" Content="読み取りアクション番号で指定" Checked="ValueMethod_Changed"/>
        </StackPanel>

        <!-- 書き込み値（直接入力） -->
        <TextBlock x:Name="lblDirectValue" Grid.Row="12" Text="書き込む値:" Margin="0,0,0,5" Visibility="Collapsed"/>
        <TextBox x:Name="txtValue" Grid.Row="13" Margin="0,0,0,15" VerticalContentAlignment="Center" Height="30" Visibility="Collapsed"/>

        <!-- 読み取りアクション選択 -->
        <TextBlock x:Name="lblReadAction" Grid.Row="12" Text="読み取りアクション:" Margin="0,0,0,5" Visibility="Collapsed"/>
        <ComboBox x:Name="cmbReadActions" Grid.Row="13" Margin="0,0,0,15" Height="30" VerticalContentAlignment="Center" Visibility="Collapsed"/>

        <!-- ボタン -->
        <StackPanel Grid.Row="15" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="OK" Width="100" Height="32" Click="BtnOk_Click" IsDefault="True" Margin="0,0,10,0"/>
            <Button Content="キャンセル" Width="100" Height="32" Click="BtnCancel_Click" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
