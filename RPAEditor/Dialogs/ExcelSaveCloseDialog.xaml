<Window x:Class="RPAEditor.Dialogs.ExcelSaveCloseDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Excel: 保存/閉じる" Height="380" Width="500"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 操作タイプ -->
        <TextBlock Grid.Row="0" Text="操作タイプ:" Margin="0,0,0,5"/>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
            <RadioButton x:Name="rbSave" Content="保存" IsChecked="True" Margin="0,0,20,0" Checked="OperationType_Changed"/>
            <RadioButton x:Name="rbClose" Content="閉じる" Checked="OperationType_Changed"/>
        </StackPanel>

        <!-- 参照方式選択 -->
        <TextBlock Grid.Row="2" Text="ファイルの指定方法:" Margin="0,0,0,5"/>
        <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,0,0,15">
            <RadioButton x:Name="rbUseFilePath" Content="ファイルパスで指定" IsChecked="True" Margin="0,0,20,0" Checked="ReferenceMethod_Changed"/>
            <RadioButton x:Name="rbUseOpenAction" Content="開くアクション番号で指定" Checked="ReferenceMethod_Changed"/>
        </StackPanel>

        <!-- ファイルパス（直接指定） -->
        <TextBlock x:Name="lblFilePath" Grid.Row="4" Text="Excelファイルパス:" Margin="0,0,0,5"/>
        <Grid x:Name="gridFilePath" Grid.Row="5" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBox x:Name="txtFilePath" Grid.Column="0" Margin="0,0,5,0" VerticalContentAlignment="Center"/>
            <Button x:Name="btnBrowse" Grid.Column="1" Content="参照..." Width="80" Click="BtnBrowse_Click"/>
        </Grid>

        <!-- 開くアクション番号選択 -->
        <TextBlock x:Name="lblOpenAction" Grid.Row="4" Text="開くアクション:" Margin="0,0,0,5" Visibility="Collapsed"/>
        <ComboBox x:Name="cmbOpenActions" Grid.Row="5" Margin="0,0,0,15" VerticalContentAlignment="Center" Visibility="Collapsed"/>

        <!-- 別名保存パス（保存の場合のみ） -->
        <TextBlock x:Name="lblSaveAsPath" Grid.Row="6" Text="別名保存先（省略時は上書き保存）:" Margin="0,0,0,5" Visibility="Visible"/>
        <Grid x:Name="gridSaveAsPath" Grid.Row="7" Margin="0,0,0,15" Visibility="Visible">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBox x:Name="txtSaveAsPath" Grid.Column="0" Margin="0,0,5,0" VerticalContentAlignment="Center"/>
            <Button x:Name="btnBrowseSaveAs" Grid.Column="1" Content="参照..." Width="80" Click="BtnBrowseSaveAs_Click"/>
        </Grid>

        <!-- 閉じる前に保存（閉じるの場合のみ） -->
        <CheckBox x:Name="chkSaveBeforeClose" Grid.Row="8" Content="閉じる前に保存する" IsChecked="True"
                  VerticalAlignment="Top" Visibility="Collapsed"/>

        <!-- ボタン -->
        <StackPanel Grid.Row="10" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="OK" Width="100" Height="32" Click="BtnOk_Click" IsDefault="True" Margin="0,0,10,0"/>
            <Button Content="キャンセル" Width="100" Height="32" Click="BtnCancel_Click" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
